import{k as e,m as a,o as s,c as t,w as l,v as r,a as c,f as o,b as h,r as u,F as n,g as i,h as p,t as d,y as _,z as m,U as f,a9 as g,aB as x,aC as y,aD as w,aE as k,aF as v,q as b,s as j}from"./index-53bd83dd.js";import{_ as C}from"./page-meta.4156fa63.js";import{_ as V}from"./u-search.6c078b51.js";import{_ as I}from"./news-card.c2612bed.js";import{_ as z}from"./z-paging.42fc37e0.js";import{_ as F}from"./_plugin-vue_export-helper.1b428a4d.js";import{g as S}from"./news.3a0c7a21.js";import"./u-icon.d48ac815.js";import"./u-image.752b41d2.js";import"./icon_visit.713e13e8.js";const U=F(e({__name:"suggest",props:{hot_search:{default:()=>({data:[],status:0})},his_search:{default:()=>[]}},emits:["search","clear"],setup(e,{emit:_}){const m=e,f=a((()=>m.hot_search.data.filter((e=>e.name)))),g=e=>{_("search",e)};return(a,m)=>{const x=p;return s(),t(x,{class:"suggest bg-white"},{default:l((()=>[1==e.hot_search.status&&r(f).length?(s(),t(x,{key:0,class:"hot"},{default:l((()=>[c(x,{class:"font-medium pl-[24rpx] pt-[26rpx] pb-[6rpx] text-lg"},{default:l((()=>[o("热门搜索")])),_:1}),c(x,{class:"w-full px-[24rpx]"},{default:l((()=>[(s(!0),h(n,null,u(r(f),((e,a)=>(s(),t(x,{key:a,class:"keyword truncate max-w-full",onClick:a=>g(e.name)},{default:l((()=>[o(d(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):i("",!0),1==e.hot_search.status&&r(f).length&&e.his_search.length?(s(),t(x,{key:1,class:"mx-[24rpx] my-[40rpx] border-b border-solid border-0 border-light"})):i("",!0),e.his_search.length?(s(),t(x,{key:2,class:"history"},{default:l((()=>[c(x,{class:"flex justify-between px-[24rpx] pb-[6rpx] pt-[26rpx]"},{default:l((()=>[c(x,{class:"text-lg font-medium"},{default:l((()=>[o("历史搜索")])),_:1}),c(x,{class:"text-xs text-muted",onClick:m[0]||(m[0]=()=>_("clear"))},{default:l((()=>[o("清空")])),_:1})])),_:1}),c(x,{class:"w-full px-[24rpx]"},{default:l((()=>[(s(!0),h(n,null,u(e.his_search,((e,a)=>(s(),t(x,{key:a,class:"keyword truncate",onClick:a=>g(e)},{default:l((()=>[o(d(e),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):i("",!0)])),_:1})}}}),[["__scopeId","data-v-75bd7f36"]]),B=F(e({__name:"search",setup(e){const a=_({hot_search:{data:[],status:1},his_search:[],result:[],searching:!1}),r=m(""),o=f(),i=e=>{r.value=e,r.value&&(a.his_search.includes(r.value)||(a.his_search.unshift(r.value),g.set(x,a.his_search))),o.value.reload(),a.searching=!0},d=async()=>{(await v({title:"温馨提示",content:"是否清空历史记录？"})).confirm&&(g.set(x,""),a.his_search=[])},F=async(e,a)=>{try{const{lists:s}=await S({keyword:r.value,page_no:e,page_size:a});o.value.complete(s)}catch(s){console.log("报错=>",s),o.value.complete(!1)}};return(async()=>{try{a.hot_search=await k()}catch(e){console.log("获取热门搜索失败=>",e)}})(),a.his_search=g.get(x)||[],(e,_)=>{const m=b(j("page-meta"),C),f=b(j("u-search"),V),g=p,x=b(j("news-card"),I),k=b(j("z-paging"),z);return s(),h(n,null,[c(m,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),c(g,{class:"search"},{default:l((()=>[c(g,{class:"px-[24rpx] py-[14rpx] bg-white"},{default:l((()=>[c(f,{modelValue:r.value,"onUpdate:modelValue":_[0]||(_[0]=e=>r.value=e),placeholder:"请输入关键词搜索",height:"72",onSearch:i,onCustom:i,onClear:_[1]||(_[1]=e=>a.searching=!1)},null,8,["modelValue"])])),_:1}),c(g,{class:"search-content"},{default:l((()=>[y(c(U,{onSearch:i,onClear:d,hot_search:a.hot_search,his_search:a.his_search},null,8,["hot_search","his_search"]),[[w,!a.searching]]),y(c(g,{class:"search-content-s pt-[20rpx]"},{default:l((()=>[c(k,{ref_key:"paging",ref:o,modelValue:a.result,"onUpdate:modelValue":_[2]||(_[2]=e=>a.result=e),onQuery:F,fixed:!1,height:"100%"},{default:l((()=>[(s(!0),h(n,null,u(a.result,(e=>(s(),t(x,{key:e.id,item:e,newsId:e.id},null,8,["item","newsId"])))),128))])),_:1},8,["modelValue"])])),_:1},512),[[w,a.searching]])])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-6f0f2122"]]);export{B as default};
