import{k as e,z as a,C as l,_ as t,a8 as s,o as u,c as o,w as c,a as i,f as r,g as n,d,v,t as _,G as p,b8 as f,a3 as m,a4 as x,b9 as y,H as b,az as h,h as g,ba as k,aM as w,q as j,s as C}from"./index-53bd83dd.js";import{_ as V}from"./tabbar.vue_vue_type_script_setup_true_lang.278729fc.js";import{y as $}from"./y-popup.8a2e1f35.js";import{b as S}from"./scene.2a9f7429.js";import{u as T}from"./voice.8de5d0dd.js";import{c as q}from"./video.f2de041d.js";import{y as z}from"./recorder.f5d42c93.js";import{_ as G}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.d48ac815.js";import"./u-badge.43d2931b.js";import"./u-parse.9d9c0a03.js";import"./u-popup.bbe0211f.js";import"./index.87441216.js";const U=G(e({__name:"create",setup(e){const G=a(),U=a({name:"请选择",voice_id:""}),A=a({name:"",scene_id:0,voice_type:1,local_voice_url:"",text:"",voice_id:""}),E=a({file:"",duration:0,currentTime:0,url:"",text:"",voice_id:""});l((e=>{e.id&&H(e.id)})),t((e=>{let a=s(),l=a[a.length-1];l.$vm.scene_id&&H(l.$vm.scene_id),l.$vm.voice_id&&(U.value.voice_id=l.$vm.voice_id,U.value.name=l.$vm.name)}));const H=e=>{S({id:e}).then((a=>{G.value=a,A.value.scene_id=e}))},I=()=>{p({url:"/digitalhuman/scene/index?backStatus=true"})},M=()=>{p({url:"/digitalhuman/voice/list?backStatus=true"})},X=e=>{E.value.file=e.file,E.value.duration=e.duration,E.value.url=e.url},B=()=>{if(1==A.value.voice_type&&""==A.value.local_voice_url){if(""==E.value.url)return void f({title:"请上传音频文件",icon:"none"});let e={};return e={file:E.value.file},void T(e).then((e=>{A.value.local_voice_url=e.url,D()}))}(2!=A.value.voice_type||""!=A.value.text)&&""!=U.value.voice_id||""!=E.value.url?(A.value.voice_id=U.value.voice_id,D()):f({title:"请完善数据",icon:"none"})},D=()=>{m({title:"提交创作中...",mask:!1}),q(A.value).then((e=>{x(),f({title:"已提交创作",icon:"none"}),setTimeout((()=>{y({url:"/digitalhuman/works/index"})}),500)})).catch((e=>{x()}))};return(e,a)=>{const l=b,t=h,s=g,p=k,f=w,m=j(C("tabbar"),V);return u(),o(s,{class:"p-20"},{default:c((()=>[i(s,{class:"mb-tab"},{default:c((()=>[i(s,{class:"p-15 bg-grey round-8"},{default:c((()=>[i(l,{class:"fs-17 fw-600 text-white"},{default:c((()=>[r("名字")])),_:1}),i(t,{placeholder:"请输入视频名称","placeholder-class":"fs-12",modelValue:A.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>A.value.name=e),class:"fs-12 mt-8 text-white"},null,8,["modelValue"])])),_:1}),i(s,{class:"bg-grey p-10 round-8 mt-10"},{default:c((()=>{var e;return[G.value?(u(),o(p,{key:0,src:null==(e=G.value)?void 0:e.local_video_url,class:"w-p-100"},null,8,["src"])):n("",!0),i(s,{class:"p-20"},{default:c((()=>[i(s,{class:"bg-purple round-30 py-10 text-center text-white","object-fit":"cover",onClick:I},{default:c((()=>[r(" 选择分身 ")])),_:1})])),_:1})]})),_:1}),i(s,{class:"mt-8"},{default:c((()=>[i(s,{class:"bg-grey p-10 round-8"},{default:c((()=>[i(s,{class:"p-30 flex flex-x-space-between fs-19 fw-600 text-grey-1"},{default:c((()=>[i(l,{class:d(1==A.value.voice_type?"text-white":""),onClick:a[1]||(a[1]=e=>A.value.voice_type=1)},{default:c((()=>[r("语音驱动")])),_:1},8,["class"]),i(l,{class:d(2==A.value.voice_type?"text-white":""),onClick:a[2]||(a[2]=e=>A.value.voice_type=2)},{default:c((()=>[r("文本驱动")])),_:1},8,["class"])])),_:1}),1==A.value.voice_type?(u(),o(s,{key:0,class:"p-15"},{default:c((()=>[i(v(z),{onSuccess:X})])),_:1})):n("",!0),2==A.value.voice_type?(u(),o(s,{key:1,class:"mt-10"},{default:c((()=>[i(s,{class:"bg-black p-10 round-8"},{default:c((()=>[i(f,{placeholder:"请输入文本",class:"fs-13 text-white","placeholder-class":"text-grey-1",modelValue:A.value.text,"onUpdate:modelValue":a[3]||(a[3]=e=>A.value.text=e)},null,8,["modelValue"])])),_:1}),i(s,{class:"p-10 round-8 border-grey-3 flex flex-y-center flex-x-space-between mt-10"},{default:c((()=>[i(s,{class:"text-white"},{default:c((()=>[i(l,{class:"iconfont icon-laba fs-17"}),i(l,{class:"fs-15 ml-4"},{default:c((()=>[r(_(U.value.name),1)])),_:1})])),_:1}),i(s,{class:"text-grey-4"},{default:c((()=>[i(l,{class:"iconfont icon-qiehuan"}),i(l,{class:"ml-4",onClick:M},{default:c((()=>[r("切换")])),_:1})])),_:1})])),_:1})])),_:1})):n("",!0)])),_:1})])),_:1}),i(s,{class:"p-20 text-white text-center fw-600 ls-2"},{default:c((()=>[""==A.value.name||0==A.value.scene_id?(u(),o(s,{key:0,class:"bg-purple-1 round-30 py-15"},{default:c((()=>[r(" 提交")])),_:1})):(u(),o(s,{key:1,class:"bg-purple round-30 py-15",onClick:B},{default:c((()=>[r("提交")])),_:1}))])),_:1})])),_:1}),i(v($),{type:"video"}),i(m)])),_:1})}}}),[["__scopeId","data-v-789ba2c8"]]);export{U as default};
