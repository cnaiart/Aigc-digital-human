import{k as e,z as a,o as t,c as s,w as l,a as o,f as r,b as u,r as n,F as c,G as i,aF as d,b8 as p,a3 as f,W as m,bg as _,a4 as g,H as v,h as b,q as x,s as h,ba as k,g as y,e as w,d as C,t as j,i as M}from"./index-53bd83dd.js";import{_ as z}from"./z-paging.42fc37e0.js";import{_ as F}from"./u-popup.bbe0211f.js";import{_ as A}from"./tabbar.vue_vue_type_script_setup_true_lang.278729fc.js";import{g as V,r as E,d as G,a as P}from"./video.f2de041d.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.d48ac815.js";import"./u-badge.43d2931b.js";const T=R(e({__name:"index",setup(e){const R=a([]),T=a(),q=a(),H=a(),I=a(),J=a(""),L=(e,a)=>{V({pageNo:e,pageSize:a}).then((e=>{T.value.complete(e.lists)}))},N=()=>{i({url:"/digitalhuman/works/create"})},Q=()=>{d({title:"修改名称",editable:!0,placeholderText:"输入新的名称",success(e){e.confirm&&e.content&&E({name:e.content,id:H.value.id}).then((e=>{q.value.close(),p({title:"修改成功"}),T.value.reload()}))}})},S=()=>{d({title:"确认删除?",content:"确认删除该视频?",success(e){e.confirm&&G({id:H.value.value}).then((e=>{q.value.close(),p({title:"删除成功"}),T.value.reload()}))}})},U=e=>{d({title:"温馨提示",content:"确认重试？",success(a){a.confirm&&(f({title:"提交中..."}),P({id:e}).then((e=>{p({title:"提交成功"})})))}})},W=()=>{f({title:"下载中..."});let e=window.navigator.userAgent.toLowerCase();console.log(e.match(/MicroMessenger/i)),"micromessenger"!==e.match(/MicroMessenger/i)?_({url:J.value,success:e=>{g();let a=(e=>{const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let s=0;s<e;s++)t+=a.charAt(Math.floor(62*Math.random()));return t})(20),t=J.value.split(".").pop();var s=document.createElement("a");s.download=`${a}.${t}`,s.href=e.tempFilePath,document.body.appendChild(s),s.click(),s.remove()}}):m({data:J.value,success(e){d({title:"复制成功",content:"链接已复制,请在外部浏览器打开下载"})}})};return(e,a)=>{const i=v,d=b,p=M,f=x(h("z-paging"),z),m=x(h("u-popup"),F),_=k,g=x(h("tabbar"),A);return t(),s(d,{class:"text-white"},{default:l((()=>[o(d,{class:"mb-tab"},{default:l((()=>[o(d,{class:"flex flex-x-space-between flex-y-center p-20"},{default:l((()=>[o(i,null,{default:l((()=>[r("我的作品")])),_:1}),o(d,{class:"block px-12 py-4 fs-13 bg-purple round-30",onClick:N},{default:l((()=>[r("去创作")])),_:1})])),_:1}),o(f,{ref_key:"paging",ref:T,modelValue:R.value,"onUpdate:modelValue":a[0]||(a[0]=e=>R.value=e),onQuery:L,"use-page-scroll":""},{default:l((()=>[o(d,{class:"grid-columns-3 grid-gap-20 px-15"},{default:l((()=>[(t(!0),u(c,null,n(R.value,((e,a)=>(t(),s(d,{class:"round-10 position-relative h-180 w-110 flex flex-center border-grey-2 over-hidden",key:a},{default:l((()=>["1"==e.status?(t(),s(d,{key:0,class:"text-center"},{default:l((()=>[o(d,{class:"spinner mb-10"},{default:l((()=>[o(d,{class:"spinner1"})])),_:1}),o(i,{class:"fs-10"},{default:l((()=>[r("生成中...")])),_:1})])),_:1})):y("",!0),"2"==e.status?(t(),s(p,{key:1,class:"w-110 round-10 h-180",mode:"aspectFill",src:e.cover_image,onClick:a=>{return t=e.api_video_url,J.value=t,void I.value.open();var t}},null,8,["src","onClick"])):y("",!0),"3"==e.status?(t(),s(d,{key:2,class:"flex flex-column grid-gap-10 text-center",onClick:w(U,["stop"])},{default:l((()=>[o(i,{class:"iconfont icon-zhongshi text-purple fs-20"}),o(i,{class:"fs-10"},{default:l((()=>[r("克隆失败,点击重试")])),_:1})])),_:1},8,["onClick"])):y("",!0),"1"!=e.status?(t(),s(d,{key:3,class:C(["position-absolute bottom--1 right--1 left--1 fs-12 py-6 flex flex-x-space-between px-12","2"==e.status?"bg-b":"bg-w"])},{default:l((()=>[o(i,{class:"text-ellipsis-1"},{default:l((()=>[r(j(e.name),1)])),_:2},1024),o(i,{class:"iconfont icon-_gengduo text-white fs-13 ml-2",style:{transform:"rotate(90deg)"},onClick:w((a=>{return t=e,H.value=t,void q.value.open();var t}),["stop"])},null,8,["onClick"])])),_:2},1032,["class"])):y("",!0)])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue"])])),_:1}),o(m,{ref_key:"popup",ref:q,borderRadius:"20",bgColor:"#fff",mode:"bottom"},{default:l((()=>[o(d,{class:"p-20 text-black text-center fs-15 round-top-10"},{default:l((()=>[o(d,{class:"bg-grey-2 round-30 py-15",onClick:Q},{default:l((()=>[r("重命名")])),_:1}),o(d,{class:"bg-grey-2 round-30 py-15 mt-15",onClick:S},{default:l((()=>[r("删除")])),_:1})])),_:1})])),_:1},512),o(m,{ref_key:"videoPopup",ref:I,mode:"bottom",borderRadius:"20"},{default:l((()=>[o(d,{class:"pb-safe-area px-20"},{default:l((()=>[o(d,{class:"py-20"},{default:l((()=>[o(_,{src:J.value,class:"w-p-100 vh-50"},null,8,["src"])])),_:1}),o(d,{class:"bg-purple round-30 text-center text-white py-15 mb-10",onClick:W},{default:l((()=>[r("下载到本地")])),_:1})])),_:1})])),_:1},512),o(g)])),_:1})}}}),[["__scopeId","data-v-91ac0d71"]]);export{T as default};
