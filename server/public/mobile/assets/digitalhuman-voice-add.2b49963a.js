import{k as e,z as l,Y as a,C as s,o as t,c as u,w as o,a as r,f as c,t as f,g as n,v as d,d as p,b as i,r as v,F as _,a3 as m,b8 as g,a4 as x,ae as y,H as b,az as h,h as k,q as w,s as j}from"./index-e4851b67.js";import{_ as C}from"./u-popup.c78c5737.js";import{y as I}from"./recorder.9a339b45.js";import{y as T}from"./y-popup.6203d34a.js";import{g as z,a as V,u as q,c as S}from"./voice.48b35bc7.js";import{g as A}from"./index.0272cd43.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.74289404.js";import"./u-parse.143af95b.js";const F=E(e({__name:"add",setup(e){const E=l(),F=l(),H=l(),R=l({file:"",duration:0,currentTime:0,url:""}),U=l({name:"",local_voice_url:"",duration:0,voice_type:1,textId:""}),X=a(),Y=l();s((()=>{B(),G()}));const B=()=>{E.value=[],1==U.value.voice_type?J():D()},D=()=>{z().then((e=>{U.value.textId=e.textId,E.value=e.textSegs,H.value=E.value[0]}))},G=()=>{A().then((e=>{Y.value=e}))},J=()=>{V().then((e=>{E.value=e.lists,H.value=E.value[0]}))},K=()=>{F.value.open()},L=e=>{H.value=e,F.value.close()},M=e=>{R.value.file=e.file,R.value.duration=e.duration,R.value.url=e.url},N=()=>{m({title:"创建中..."}),S({...U.value}).then((e=>{g({title:"添加成功",icon:"none"}),x(),setTimeout((()=>{y()}),500)}))};return(e,l)=>{const a=b,s=h,m=k,g=w(j("u-popup"),C);return t(),u(m,{class:"y-page"},{default:o((()=>[r(m,{class:"p-20 text-white"},{default:o((()=>[r(m,{class:"bg-grey p-15 round-8"},{default:o((()=>[r(a,{class:"fs-17 fw-600"},{default:o((()=>[c("名字")])),_:1}),r(s,{placeholder:"请输入声音名称","placeholder-class":"fs-12",class:"fs-12 mt-8",modelValue:U.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>U.value.name=e)},null,8,["modelValue"])])),_:1}),r(m,{class:"bg-grey mt-7 p-15 round-8"},{default:o((()=>[r(a,{class:"fs-17 fw-600"},{default:o((()=>[c("参考音频")])),_:1}),r(m,{class:"round-8 border-purple p-15 mt-7"},{default:o((()=>[r(m,{class:"flex flex-x-space-between mb-6"},{default:o((()=>[r(a,{class:"fs-15 fw-600"},{default:o((()=>[c("朗读文本")])),_:1}),r(m,{class:"bg-white fs-12 round-4 text-purple flex flex-y-center px-6 py-4",onClick:K},{default:o((()=>[r(a,{class:"iconfont icon-qiehuan",style:{color:"var(--purple)"}}),c(" 切换文本 ")])),_:1})])),_:1}),1==U.value.voice_type?(t(),u(a,{key:0,class:"fs-11 text-grey-4 ls-2"},{default:o((()=>{var e;return[c(f(null==(e=H.value)?void 0:e.content),1)]})),_:1})):n("",!0),2==U.value.voice_type?(t(),u(a,{key:1,class:"fs-11 text-grey-4 ls-2"},{default:o((()=>{var e;return[c(f(null==(e=H.value)?void 0:e.segText),1)]})),_:1})):n("",!0)])),_:1}),r(m,{class:"p-30"},{default:o((()=>[r(d(I),{onSuccess:M})])),_:1})])),_:1}),r(m,{class:"p-20 text-white text-center fw-600 ls-2"},{default:o((()=>[r(m,{class:p(["round-30 py-15",""===U.value.name||""===R.value.url?"bg-purple-1":"bg-purple"]),onClick:l[1]||(l[1]=e=>U.value.name&&R.value.url?(()=>{if(""==U.value.local_voice_url){let e={};e={file:R.value.file},q(e,X.token).then((e=>{U.value.local_voice_url=e.url,N()}))}else N()})():null)},{default:o((()=>{var e;return[c(" 消耗"+f(null==(e=Y.value)?void 0:e.voice_points)+"算力点创建 ",1)]})),_:1},8,["class"])])),_:1}),r(g,{ref_key:"popup",ref:F,borderRadius:"20",mode:"bottom","safe-area-inset-bottom":!0},{default:o((()=>[r(m,{class:"p-20 text-black box-sizing",style:{"max-height":"50vh"}},{default:o((()=>[r(m,{class:"fw-600 text-center"},{default:o((()=>[r(a,null,{default:o((()=>[c("选择朗读文本")])),_:1})])),_:1}),1==U.value.voice_type?(t(),u(m,{key:0,class:"flex flex-column mt-7 grid-gap-6 overflow-y-scroll"},{default:o((()=>[(t(!0),i(_,null,v(E.value,((e,l)=>(t(),u(m,{class:p(["round-10 p-15 bg-grey-2 flex flex-column grid-gap-4",H.value.id==e.id?"border-purple":"border-grey-2"]),key:l,onClick:l=>L(e)},{default:o((()=>[r(a,{class:"fw-600"},{default:o((()=>[c(f(e.name),1)])),_:2},1024),r(a,{class:"ls-2 fs-12"},{default:o((()=>[c(f(e.content),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})):n("",!0),2==U.value.voice_type?(t(),u(m,{key:1,class:"flex flex-column mt-7 grid-gap-6 overflow-y-scroll"},{default:o((()=>[(t(!0),i(_,null,v(E.value,((e,l)=>(t(),u(m,{class:p(["round-10 p-15 bg-grey-2 flex flex-column grid-gap-4",H.value.segId==e.segId?"border-purple":"border-grey-2"]),key:l,onClick:l=>L(e)},{default:o((()=>[r(a,{class:"ls-2 fs-12"},{default:o((()=>[c(f(e.segText),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})):n("",!0)])),_:1})])),_:1},512),r(d(T))])),_:1})])),_:1})}}}),[["__scopeId","data-v-caef35ef"]]);export{F as default};
