import{k as e,z as a,C as l,_ as t,a8 as s,o as u,c,w as i,a as o,f as r,g as d,d as n,v,t as _,G as p,b8 as f,a3 as m,a4 as x,b9 as y,H as b,az as g,h,ba as w,aM as k,q as j,s as C,bb as V}from"./index-e4851b67.js";import{_ as $}from"./tabbar.vue_vue_type_script_setup_true_lang.6b2a383b.js";import{y as S}from"./y-popup.6203d34a.js";import{b as T}from"./scene.28bc32b5.js";import{u as q}from"./voice.48b35bc7.js";import{c as z}from"./video.4225e33e.js";import{y as G}from"./recorder.9a339b45.js";import{_ as U}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.74289404.js";import"./u-badge.4774cf88.js";import"./u-parse.143af95b.js";import"./u-popup.c78c5737.js";import"./index.0272cd43.js";const A=U(e({__name:"create",setup(e){const U=a(),A=a({name:"请选择",voice_id:""}),E=a({name:"",scene_id:0,voice_type:1,local_voice_url:"",text:"",voice_id:""}),H=a({file:"",duration:0,currentTime:0,url:"",text:"",voice_id:""});l((e=>{e.id&&I(e.id)})),t((e=>{let a=s(),l=a[a.length-1];l.$vm.scene_id&&I(l.$vm.scene_id),l.$vm.voice_id&&(A.value.voice_id=l.$vm.voice_id,A.value.name=l.$vm.name)}));const I=e=>{T({id:e}).then((a=>{U.value=a,E.value.scene_id=e}))},M=()=>{p({url:"/digitalhuman/scene/index?backStatus=true"})},X=()=>{p({url:"/digitalhuman/voice/list?backStatus=true"})},B=e=>{H.value.file=e.file,H.value.duration=e.duration,H.value.url=e.url},D=()=>{if(1==E.value.voice_type&&""==E.value.local_voice_url){if(""==H.value.url)return void f({title:"请上传音频文件",icon:"none"});let e={};return e={file:H.value.file},void q(e).then((e=>{E.value.local_voice_url=e.url,F()}))}(2!=E.value.voice_type||""!=E.value.text)&&""!=A.value.voice_id||""!=H.value.url?(E.value.voice_id=A.value.voice_id,F()):f({title:"请完善数据",icon:"none"})},F=()=>{m({title:"提交创作中...",mask:!1}),z(E.value).then((e=>{x(),f({title:"已提交创作",icon:"none"}),setTimeout((()=>{y({url:"/digitalhuman/works/index"})}),500)})).catch((e=>{x()}))};return(e,a)=>{const l=b,t=g,s=h,p=w,f=k,m=j(C("tabbar"),$),x=V("viwe");return u(),c(x,{class:"y-page"},{default:i((()=>[o(s,{class:"p-20"},{default:i((()=>[o(s,{class:"mb-tab"},{default:i((()=>[o(s,{class:"p-15 bg-grey round-8"},{default:i((()=>[o(l,{class:"fs-17 fw-600 text-white"},{default:i((()=>[r("名字")])),_:1}),o(t,{placeholder:"请输入视频名称","placeholder-class":"fs-12",modelValue:E.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>E.value.name=e),class:"fs-12 mt-8 text-white"},null,8,["modelValue"])])),_:1}),o(s,{class:"bg-grey p-10 round-8 mt-10"},{default:i((()=>{var e;return[U.value?(u(),c(p,{key:0,src:null==(e=U.value)?void 0:e.local_video_url,class:"w-p-100"},null,8,["src"])):d("",!0),o(s,{class:"p-20"},{default:i((()=>[o(s,{class:"bg-purple round-30 py-10 text-center text-white","object-fit":"cover",onClick:M},{default:i((()=>[r(" 选择分身 ")])),_:1})])),_:1})]})),_:1}),o(s,{class:"mt-8"},{default:i((()=>[o(s,{class:"bg-grey p-10 round-8"},{default:i((()=>[o(s,{class:"p-30 flex flex-x-space-between fs-19 fw-600 text-grey-1"},{default:i((()=>[o(l,{class:n(1==E.value.voice_type?"text-white":""),onClick:a[1]||(a[1]=e=>E.value.voice_type=1)},{default:i((()=>[r("语音驱动")])),_:1},8,["class"]),o(l,{class:n(2==E.value.voice_type?"text-white":""),onClick:a[2]||(a[2]=e=>E.value.voice_type=2)},{default:i((()=>[r("文本驱动")])),_:1},8,["class"])])),_:1}),1==E.value.voice_type?(u(),c(s,{key:0,class:"p-15"},{default:i((()=>[o(v(G),{onSuccess:B})])),_:1})):d("",!0),2==E.value.voice_type?(u(),c(s,{key:1,class:"mt-10"},{default:i((()=>[o(s,{class:"bg-black p-10 round-8"},{default:i((()=>[o(f,{placeholder:"请输入文本",class:"fs-13 text-white","placeholder-class":"text-grey-1",modelValue:E.value.text,"onUpdate:modelValue":a[3]||(a[3]=e=>E.value.text=e)},null,8,["modelValue"])])),_:1}),o(s,{class:"p-10 round-8 border-grey-3 flex flex-y-center flex-x-space-between mt-10"},{default:i((()=>[o(s,{class:"text-white"},{default:i((()=>[o(l,{class:"iconfont icon-laba fs-17"}),o(l,{class:"fs-15 ml-4"},{default:i((()=>[r(_(A.value.name),1)])),_:1})])),_:1}),o(s,{class:"text-grey-4"},{default:i((()=>[o(l,{class:"iconfont icon-qiehuan"}),o(l,{class:"ml-4",onClick:X},{default:i((()=>[r("切换")])),_:1})])),_:1})])),_:1})])),_:1})):d("",!0)])),_:1})])),_:1}),o(s,{class:"p-20 text-white text-center fw-600 ls-2"},{default:i((()=>[""==E.value.name||0==E.value.scene_id?(u(),c(s,{key:0,class:"bg-purple-1 round-30 py-15"},{default:i((()=>[r(" 提交")])),_:1})):(u(),c(s,{key:1,class:"bg-purple round-30 py-15",onClick:D},{default:i((()=>[r("提交")])),_:1}))])),_:1})])),_:1}),o(v(S),{type:"video"}),o(m)])),_:1})])),_:1})}}}),[["__scopeId","data-v-13eb2dbc"]]);export{A as default};
